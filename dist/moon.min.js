/*
* Moon 0.1.3
* Copyright 2016-2017, Kabir Shah
* https://github.com/KingPixil/moon/
* Free to use under the MIT license.
* https://kingpixil.github.io/license
*/
!function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Moon=e()}(this,function(){function t(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function e(r){this.$opts=r||{};var s=this,h=this.$opts.data;this.$id=i++,this.$render=this.$opts.render||p,this.$hooks=t({created:p,mounted:p,updated:p,destroyed:p},this.$opts.hooks),this.$methods=this.$opts.methods||{},this.$components=t(this.$opts.components||{},o),this.$directives=t(this.$opts.directives||{},n),this.$events={},this.$dom={},this.$destroyed=!1,Object.defineProperty(this,"$data",{get:function(){return h},set:function(t){h=t,this.build(this.$dom.children)},configurable:!0}),n[e.config.prefix+"if"]=function(t,e,n){var o=new Function("return "+e);if(o())for(var i=0;i<n.children.length;i++)n.children[i].meta.shouldRender=!0;else for(var i=0;i<n.children.length;i++)n.children[i].node.textContent="",n.children[i].meta.shouldRender=!1},n[e.config.prefix+"show"]=function(t,e,n){var o=new Function("return "+e);o()?t.style.display="block":t.style.display="none"},n[e.config.prefix+"on"]=function(t,n,o){var i=n.split(":"),r=i[0],h=i[1];s.$events[r]?s.on(r,h):t.addEventListener(r,function(t){s.callMethod(h,[t])}),delete o.props[e.config.prefix+"on"]},n[e.config.prefix+"model"]=function(t,n,o){t.value=s.get(n),t.addEventListener("input",function(){s.set(n,t.value)}),delete o.props[e.config.prefix+"model"]},n[e.config.prefix+"for"]=function(t,e,n){var o=e.split(" in ");o[0],s.get(o[1])},n[e.config.prefix+"once"]=function(t,e,n){n.meta.shouldRender=!1},n[e.config.prefix+"text"]=function(t,e,n){t.textContent=e},n[e.config.prefix+"html"]=function(t,e,n){t.innerHTML=e},n[e.config.prefix+"mask"]=function(t,e,n){},this.init()}var n={},o={},i=0,r=function(t,e,n,o,i){return{type:t,val:e,props:n,children:o,meta:i||{shouldRender:!0}}},s=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),n=t.shift()||{},o=t;return"string"==typeof o[0]&&(o[0]=r("#text",o[0],{},[],defaultMeta())),r(e,o.join(""),n,o,defaultMeta())},h=function(t){return console.log('return "'+t.replace(/"/g,'\\"')+'"'),new Function('return "'+t.replace(/"/g,'\\"')+'"')},p=function(){};return e.prototype.log=function(t){e.config.silent||console.log(t)},e.prototype.error=function(t){console.error("[Moon] ERR: "+t)},e.prototype.get=function(t){return this.$data[t]},e.prototype.set=function(t,e){this.$data[t]=e,this.$destroyed||this.build(),this.$hooks.updated()},e.prototype.destroy=function(){Object.defineProperty(this,"$data",{set:function(t){_data=t}}),this.removeEvents(),this.$destroyed=!0,this.$hooks.destroyed()},e.prototype.callMethod=function(t,e){e=e||[],this.$methods[t].apply(this,e)},e.prototype.on=function(t,e){this.$events[t]?this.$events[t].push(e):this.$events[t]=[e]},e.prototype.off=function(t,e){var n=this.$events[t].indexOf(e);n!==-1&&this.$events[t].splice(n,1)},e.prototype.removeEvents=function(){for(var t in this.$events)this.$events[t]=[]},e.prototype.emit=function(t,e){if(e=e||{},e.type=t,this.$events["*"])for(var n=0;n<this.$events["*"].length;n++){var o=this.$events["*"][n];o(e)}for(var n=0;n<this.$events[t].length;n++){var i=this.$events[t][n];i(e)}},e.prototype.mount=function(t){this.$el=document.querySelector(t),this.$el||this.error("Element "+this.$opts.el+" not found"),this.$template=this.$opts.template||this.$el.innerHTML,this.$el.innerHTML=this.$template,this.$render===p&&(this.$render=h(this.$template)),this.build(),this.$hooks.mounted()},e.prototype.render=function(){return this.$render(s)},e.prototype.patch=function(t,e){},e.prototype.build=function(){this.$dom=this.render(),this.patch(this.$el,this.$dom)},e.prototype.init=function(){this.log("======= Moon ======="),this.$hooks.created(),this.$opts.el&&this.mount(this.$opts.el)},e.config={silent:!1,prefix:"m-"},e.use=function(t){t.init(e)},e.directive=function(t,o){n[e.config.prefix+t]=o},e.component=function(t,n){function i(){e.call(this,n)}var r=this;i.prototype=Object.create(r.prototype),i.prototype.constructor=i;var s=new i;return o[t]=s,s},e});