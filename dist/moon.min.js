/*
* Moon 0.1.3
* Copyright 2016-2017, Kabir Shah
* https://github.com/KingPixil/moon/
* Free to use under the MIT license.
* https://kingpixil.github.io/license
*/
!function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Moon=e()}(this,function(){function t(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function e(e){this.$opts=e||{};var s=this,h=this.$opts.data;this.$id=r++,this.$el=document.querySelector(this.$opts.el),this.$el||this.error("Element "+this.$opts.el+" not found"),this.$template=this.$opts.template||this.$el.innerHTML,this.$render=this.$opts.render||c,this.$hooks=t({created:c,mounted:c,updated:c,destroyed:c},this.$opts.hooks),this.$methods=this.$opts.methods||{},this.$components=t(this.$opts.components||{},i),this.$directives=t(this.$opts.directives||{},o),this.$events={},this.$dom={},this.$destroyed=!1,Object.defineProperty(this,"$data",{get:function(){return h},set:function(t){h=t,this.build(this.$dom.children)},configurable:!0}),o[n.prefix+"if"]=function(t,e,n){var o=new Function("return "+e);if(o()){t.textContent=n.val;for(var i=0;i<n.children.length;i++)n.children[i].shouldRender=!1}else{t.textContent="<!---->";for(var i=0;i<n.children.length;i++)n.children[i].shouldRender=!1}},o[n.prefix+"show"]=function(t,e,n){var o=new Function("return "+e);o()?t.style.display="block":t.style.display="none"},o[n.prefix+"on"]=function(t,e,o){var i=e.split(":"),r=i[0],h=i[1];s.$events[r]?s.emit(r):t.addEventListener(r,function(t){s.callMethod(h,[t])}),delete o.props[n.prefix+"on"]},o[n.prefix+"model"]=function(t,e,o){t.value=s.get(e),t.addEventListener("input",function(){s.set(e,t.value)}),delete o.props[n.prefix+"model"]},o[n.prefix+"for"]=function(t,e,n){var o=e.split(" in ");o[0],s.get(o[1])},o[n.prefix+"once"]=function(t,e,n){n.meta.shouldRender=!1},o[n.prefix+"text"]=function(t,e,n){t.textContent=e},o[n.prefix+"html"]=function(t,e,n){t.innerHTML=e},o[n.prefix+"mask"]=function(t,e,n){},this.init()}var n={silent:!1,prefix:"m-"},o={},i={},r=0,s=function(t){var e=t,n=/{{([A-Za-z0-9_.()\[\]]+)}}/gi;e.replace(n,function(t,n){e=e.replace(t,"' + data['"+n+"'] + '")}),e=e.replace(/\n/g,"' + \n'");var o=new Function("data","var out = '"+e+"'; return out");return o},h=function(t){var e={};if(!t.attributes)return e;for(var n=t.attributes,o=0;o<n.length;o++)e[n[o].name]=s(n[o].value);return e},d=function(t,e,n,o,i,r){return{type:t,val:e,props:n,children:o,meta:i,node:r}},p=function(t){for(var e=t.nodeName,n="#text"===e?s(t.textContent):t.textContent,o=h(t),i={once:!1,shouldRender:!0},r=[],u=0;u<t.childNodes.length;u++)r.push(p(t.childNodes[u]));return d(e,n,o,r,i,t)},u=function(t,e){t.innerHTML=e},c=function(){},l=void 0!==typeof window.console;return e.prototype.log=function(t){!n.silent&&l&&console.log(t)},e.prototype.error=function(t){l&&console.error("[Moon] ERR: "+t)},e.prototype.set=function(t,e){this.$data[t]=e,this.$destroyed||this.build(this.$dom.children),this.$hooks.updated()},e.prototype.get=function(t){return this.$data[t]},e.prototype.callMethod=function(t,e){e=e||[],this.$methods[t].apply(this,e)},e.prototype.on=function(t,e){this.$events[t]?this.$events[t].push(e):this.$events[t]=[]},e.prototype.off=function(t,e){var n=this.$events[t].indexOf(e);n!==-1&&this.$events[t].splice(n,1)},e.prototype.emit=function(t,e){e=e||{},e.type=t;for(var n=0;n<this.$events[t].length;n++){var o=this.$events[t][n];o(e)}},e.prototype.destroy=function(){Object.defineProperty(this,"$data",{set:function(t){_data=t}}),this.$destroyed=!0,this.$hooks.destroyed()},e.prototype.build=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.meta.shouldRender){if("#text"===n.type){var i="";i=n.val(this.$data),n.node.textContent=i}else if(n.props)for(var r in n.props){var s=n.props[r](this.$data);o[r]?(n.node.removeAttribute(r),o[r](n.node,s,n)):n.node.setAttribute(r,s)}this.build(n.children)}}},e.prototype.init=function(){this.log("======= Moon ======="),this.$hooks.created(),u(this.$el,this.$template),this.$dom=p(this.$el),this.build(this.$dom.children),this.$hooks.mounted()},e.config=function(t){t.silent&&(n.silent=t.silent),t.prefix&&(n.prefix=t.prefix+"-")},e.use=function(t){t.init(e)},e.directive=function(t,e){o[n.prefix+t]=e},e.component=function(t,n){function o(){e.call(this,n)}var r=this;o.prototype=Object.create(r.prototype),o.prototype.constructor=o;var s=new o;return i[t]=s,s},e});