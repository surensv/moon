/*
* Moon 0.1.3
* Copyright 2016-2017, Kabir Shah
* https://github.com/KingPixil/moon/
* Free to use under the MIT license.
* https://kingpixil.github.io/license
*/
!function(t,e){"object"==typeof module&&module.exports?module.exports=e():t.Moon=e()}(this,function(){function t(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}function e(e){this.$opts=e||{};var d=this,h=this.$opts.data;this.$id=r++,this.$el=document.querySelector(this.$opts.el),this.$el||this.error("Element "+this.$opts.el+" not found"),this.$template=this.$opts.template||this.$el.innerHTML,this.$render=this.$opts.render||u,this.$hooks=t({created:u,mounted:u,updated:u,destroyed:u},this.$opts.hooks),this.$methods=this.$opts.methods||{},this.$components=t(this.$opts.components||{},n),this.$directives=t(this.$opts.directives||{},i),this.$dom={},this.$destroyed=!1,Object.defineProperty(this,"$data",{get:function(){return h},set:function(t){h=t,this.build(this.$el.childNodes,this.$dom.children)},configurable:!0}),i[o.prefix+"if"]=function(t,e,o){var i=new Function("return "+e);i()?t.textContent=s(o.val,d.$data):t.textContent=""},i[o.prefix+"show"]=function(t,e,o){var i=new Function("return "+e);i()?t.style.display="block":t.style.display="none"},i[o.prefix+"on"]=function(t,e,i){var n=e.split(":"),r=n[0],s=n[1];t.addEventListener(r,function(){d.callMethod(s)}),delete i.props[o.prefix+"on"]},i[o.prefix+"model"]=function(t,e,i){t.value=d.get(e),t.addEventListener("input",function(){d.set(e,t.value)}),delete i.props[o.prefix+"model"]},i[o.prefix+"for"]=function(t,e,o){var i=e.split(" in ");i[0],d.get(i[1])},i[o.prefix+"once"]=function(t,e,o){o.val=t.textContent;for(var i in o.children)o.children[i].val=s(o.children[i].val,d.$data)},i[o.prefix+"text"]=function(t,e,o){t.textContent=e},i[o.prefix+"html"]=function(t,e,o){t.innerHTML=e},i[o.prefix+"mask"]=function(t,e,o){},this.init()}var o={silent:!1,prefix:"m-"},i={},n={},r=0,s=function(t,e){var o=t,i=/{{([A-Za-z0-9_.()\[\]]+)}}/gi;o.replace(i,function(t,e){o=o.replace(t,"' + data['"+e+"'] + '")}),o=o.replace(/\n/g,"' + \n'");var n=new Function("data","var out = '"+o+"'; return out"),r=n(e);return r},d=function(t){var e={};if(!t.attributes)return e;for(var o=t.attributes,i=0;i<o.length;i++)e[o[i].name]=o[i].value;return e},h=function(t,e,o,i){return{type:t,val:e,props:o,children:i}},c=function(t){for(var e=[],o=0;o<t.childNodes.length;o++)e.push(c(t.childNodes[o]));return h(t.nodeName,t.textContent,d(t),e)},p=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),o=t.shift()||{},i=t;return h(e,i.join(""),o,i)},l=function(t,e){t.innerHTML=e},u=function(){},a=void 0!==typeof window.console;return e.prototype.log=function(t){!o.silent&&a&&console.log(t)},e.prototype.error=function(t){a&&console.error("[Moon] ERR: "+t)},e.prototype.set=function(t,e){this.$data[t]=e,this.$destroyed||this.build(this.$el.childNodes,this.$dom.children),this.$hooks.updated()},e.prototype.get=function(t){return this.$data[t]},e.prototype.callMethod=function(t){this.$methods[t]()},e.prototype.destroy=function(){Object.defineProperty(this,"$data",{set:function(t){_data=t}}),this.$destroyed=!0,this.$hooks.destroyed()},e.prototype.build=function(t,e){for(var o=0;o<t.length;o++){var n=e[o],r=t[o];if(void 0!==n){if("#text"===r.nodeName){var d=n.val;void 0===d&&(d=n),r.textContent=s(d,this.$data)}else if(n.props)for(var h in n.props){var c=s(n.props[h],this.$data);i[h]?(r.removeAttribute(h),i[h](r,c,n)):r.setAttribute(h,c)}this.build(r.childNodes,n.children)}}},e.prototype.init=function(){this.log("======= Moon ======="),this.$hooks.created(),l(this.$el,this.$template),this.$render!==u?this.$dom=this.$render(p):this.$dom=c(this.$el),this.build(this.$el.childNodes,this.$dom.children),this.$hooks.mounted()},e.config=function(t){t.silent&&(o.silent=t.silent),t.prefix&&(o.prefix=t.prefix+"-")},e.use=function(t){t.init(e)},e.directive=function(t,e){i[o.prefix+t]=e},e.component=function(t,o){function i(){e.call(this,o)}var r=this;i.prototype=Object.create(r.prototype),i.prototype.constructor=i;var s=new i;return n[t]=s,s},e});